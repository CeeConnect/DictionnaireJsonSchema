{
  "$id": "https://raw.githubusercontent.com/CeeConnect/DictionnaireJsonSchema/bundle/fiche/bar/BAR-EN-103",
  "$schema": "https://raw.githubusercontent.com/CeeConnect/DictionnaireJsonSchema/main/meta-schema.json",
  "title": "BAR-EN-103",
  "description": "Isolation d’un plancher",
  "type": "object",
  "properties": {
    "_template": {
      "type": "string",
      "default": "montant",
      "oneOf": [
        {
          "const": "montant",
          "title": "Montant"
        },
        {
          "const": "attestation",
          "title": "Attestation"
        }
      ]
    }
  },
  "dependentSchemas": {
    "_template": {
      "oneOf": [
        {
          "properties": {
            "_template": {
              "const": "montant"
            }
          },
          "allOf": [
            {
              "$ref": "#/$defs/montant"
            }
          ]
        },
        {
          "properties": {
            "_template": {
              "const": "attestation"
            }
          },
          "allOf": [
            {
              "$ref": "#/$defs/attestation"
            }
          ]
        }
      ]
    },
    "$defs": {
      "anciennete": {
        "$ref": "https://raw.githubusercontent.com/CeeConnect/DictionnaireJsonSchema/main/type/bar/batiment/existant.json"
      },
      "type": {
        "$ref": "https://raw.githubusercontent.com/CeeConnect/DictionnaireJsonSchema/main/type/bar/type.json"
      },
      "quantiteIsolant": {
        "$ref": "https://schemas.ceeconnect.fr/type/common/operation/quantite-isolant"
      },
      "codeDepartement": {
        "$ref": "https://raw.githubusercontent.com/CeeConnect/DictionnaireJsonSchema/main/type/common/code-departement.json"
      },
      "epaisseurIsolant": {
        "title": "Epaisseur de l'isolant",
        "type": "number",
        "minimum": 0,
        "unit": "mm"
      },
      "resistanceIsolant": {
        "title": "Résistance thermmique de l'isolant",
        "type": "number",
        "minimum": 0,
        "unit": "m2.K/W"
      },
      "posePareVapeur": {
        "title": "Mise en place d'un pare-vapeur",
        "description": "L’isolation thermique réalisée a nécessité la mise en place d’un pare-vapeur ou tout autre dispositif permettant d'atteindre un résultat équivalent",
        "type": "boolean"
      },
      "mentionMarqueReference": {
        "$ref": "https://raw.githubusercontent.com/CeeConnect/DictionnaireJsonSchema/main/meta-schema.json"
      },
      "installateur": {
        "$ref": "https://raw.githubusercontent.com/CeeConnect/DictionnaireJsonSchema/main/bundle/dossier/partie-a/bar/_installateur.json"
      },
      "montant": {
        "properties": {
          "batiment": {
            "title": "Bâtiment",
            "type": "object",
            "properties": {
              "anciennete": {
                "$ref": "#/$defs/anciennete"
              },
              "type": {
                "$ref": "#/$defs/type"
              }
            },
            "required": [
              "anciennete",
              "type"
            ]
          },
          "operation": {
            "title": "Opération",
            "type": "object",
            "properties": {
              "codeDepartement": {
                "$ref": "#/$defs/codeDepartement"
              },
              "quantiteIsolant": {
                "$ref": "#/$defs/quantiteIsolant"
              }
            },
            "required": [
              "codeDepartement",
              "quantiteIsolant"
            ]
          }
        },
        "required": [
          "batiment",
          "operation"
        ]
      },
      "attestation": {
        "properties": {
          "operation": {
            "properties": {
              "dateVisitePrealable": {
                "$ref": "#/$defs/dateVisitePrealable"
              },
              "dateDebut": {
                "$ref": "#/$defs/dateDebut"
              },
              "epaisseurIsolant": {
                "$ref": "#/$defs/epaisseurIsolant"
              },
              "resistanceIsolant": {
                "$ref": "#/$defs/resistanceIsolant",
                "minimum": 3
              },
              "posePareVapeur": {
                "$ref": "#/$defs/posePareVapeur"
              }
            },
            "required": [
              "posePareVapeur",
              "resistanceIsolant",
              "epaisseurIsolant"
            ]
          },
          "mentionMarqueReference": {
            "$ref": "#/$defs/mentionMarqueReference"
          },
          "installateur": {
            "$ref": "#/$defs/installateur"
          },
          "required": [
            "mentionMarqueReference",
            "installateur"
          ]
        }
      }
    }
  }
}